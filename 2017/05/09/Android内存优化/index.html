<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    

    <title>
      Androidå†…å­˜ä¼˜åŒ– | çŸ¥,è¡Œ|Mrx 
    </title>

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    
      <meta name="author" content="Mrx">
    
    

    <meta name="description" content="æœ¬ç« å‚è€ƒgoogleå®˜æ–¹æ–‡æ¡£ï¼Œæ€»ç»“äº†androidå¼€å‘è¿‡ç¨‹ä¸­å†…å­˜ä¼˜åŒ–çš„æ–¹æ³•ï¼ŒåŒæ—¶ï¼Œç»“åˆå®é™…å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°çš„OOMï¼Œæ€»ç»“äº†éƒ¨åˆ†ç»éªŒã€‚ä¸å½“ä¹‹å¤„ï¼Œè¯·éšæ—¶æå‡ºã€‚">
<meta name="keywords" content="å†…å­˜,ä¼˜åŒ–">
<meta property="og:type" content="article">
<meta property="og:title" content="Androidå†…å­˜ä¼˜åŒ– | çŸ¥,è¡Œ|Mrx">
<meta property="og:url" content="http://www.mrxyx.cn/2017/05/09/Androidå†…å­˜ä¼˜åŒ–/index.html">
<meta property="og:site_name" content="çŸ¥,è¡Œ|Mrx">
<meta property="og:description" content="æœ¬ç« å‚è€ƒgoogleå®˜æ–¹æ–‡æ¡£ï¼Œæ€»ç»“äº†androidå¼€å‘è¿‡ç¨‹ä¸­å†…å­˜ä¼˜åŒ–çš„æ–¹æ³•ï¼ŒåŒæ—¶ï¼Œç»“åˆå®é™…å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°çš„OOMï¼Œæ€»ç»“äº†éƒ¨åˆ†ç»éªŒã€‚ä¸å½“ä¹‹å¤„ï¼Œè¯·éšæ—¶æå‡ºã€‚">
<meta property="og:image" content="https://raw.githubusercontent.com/Mrxyx/MarkPhotos/master/Res/2017050901.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Mrxyx/MarkPhotos/master/Res/2017050902.png">
<meta property="og:updated_time" content="2017-05-09T12:56:18.850Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Androidå†…å­˜ä¼˜åŒ– | çŸ¥,è¡Œ|Mrx">
<meta name="twitter:description" content="æœ¬ç« å‚è€ƒgoogleå®˜æ–¹æ–‡æ¡£ï¼Œæ€»ç»“äº†androidå¼€å‘è¿‡ç¨‹ä¸­å†…å­˜ä¼˜åŒ–çš„æ–¹æ³•ï¼ŒåŒæ—¶ï¼Œç»“åˆå®é™…å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°çš„OOMï¼Œæ€»ç»“äº†éƒ¨åˆ†ç»éªŒã€‚ä¸å½“ä¹‹å¤„ï¼Œè¯·éšæ—¶æå‡ºã€‚">
<meta name="twitter:image" content="https://raw.githubusercontent.com/Mrxyx/MarkPhotos/master/Res/2017050901.png">
    
    
    
      <link rel="icon" type="image/x-icon" href="/favicon.ico">
    
    <link rel="stylesheet" href="/css/uno.css">
    <link rel="stylesheet" href="/css/highlight.css">
    <link rel="stylesheet" href="/css/archive.css">
    <link rel="stylesheet" href="/css/china-social-icon.css">

</head>
<body>

    <span class="mobile btn-mobile-menu">
        <i class="icon icon-list btn-mobile-menu__icon"></i>
        <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
    </span>

    

<header class="panel-cover panel-cover--collapsed">


  <div class="panel-main">

  
    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">

        

        <h1 class="panel-cover__title panel-title"><a href="/" title="link to homepage">çŸ¥,è¡Œ|Mrx</a></h1>
        <hr class="panel-cover__divider" />

        
        <p class="panel-cover__description">
          æ¢¦æƒ³æ˜Ÿè¾°å¤§æµ·çš„äººï¼Œæ³¨å®šå­¤ç‹¬
        </p>
        <hr class="panel-cover__divider panel-cover__divider--secondary" />
        

        <div class="navigation-wrapper">

          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">

              
                
                <li class="navigation__item"><a href="/#blog" title="" class="blog-button">é¦–é¡µ</a></li>
              
                
                <li class="navigation__item"><a href="/about" title="" class="">å…³äº</a></li>
              
                
                <li class="navigation__item"><a href="/archive" title="" class="">å½’æ¡£</a></li>
              

            </ul>
          </nav>

          <!-- ----------------------------
To add a new social icon simply duplicate one of the list items from below
and change the class in the <i> tag to match the desired social network
and then add your link to the <a>. Here is a full list of social network
classes that you can use:

    icon-social-500px
    icon-social-behance
    icon-social-delicious
    icon-social-designer-news
    icon-social-deviant-art
    icon-social-digg
    icon-social-dribbble
    icon-social-facebook
    icon-social-flickr
    icon-social-forrst
    icon-social-foursquare
    icon-social-github
    icon-social-google-plus
    icon-social-hi5
    icon-social-instagram
    icon-social-lastfm
    icon-social-linkedin
    icon-social-medium
    icon-social-myspace
    icon-social-path
    icon-social-pinterest
    icon-social-rdio
    icon-social-reddit
    icon-social-skype
    icon-social-spotify
    icon-social-stack-overflow
    icon-social-steam
    icon-social-stumbleupon
    icon-social-treehouse
    icon-social-tumblr
    icon-social-twitter
    icon-social-vimeo
    icon-social-xbox
    icon-social-yelp
    icon-social-youtube
    icon-social-zerply
    icon-mail

-------------------------------->

<!-- add social info here -->



<nav class="cover-navigation navigation--social">
  <ul class="navigation">

    
      <!-- Github -->
      <li class="navigation__item">
        <a href="https://github.com/Mrxyx" title="Huno on GitHub">
          <i class='icon icon-social-github'></i>
          <span class="label">GitHub</span>
        </a>
      </li>
    

    <!-- China social icon -->
    <!--
    
      <li class="navigation__item">
        <a href="" title="">
          <i class='icon cs-icon-douban'></i>
          <span class="label">Douban</span>
        </a>
      </li>

      <li class="navigation__item">
        <a href="" title="">
          <i class='icon cs-icon-weibo'></i>
          <span class="label">Weibo</span>
        </a>
      </li>

    -->



  </ul>
</nav>



        </div>

      </div>

    </div>

    <div class="panel-cover--overlay"></div>
  </div>
</header>

    <div class="content-wrapper">
        <div class="content-wrapper__inner entry">
            

<article class="post-container post-container--single">

  <header class="post-header">
    
    <h1 class="post-title">Androidå†…å­˜ä¼˜åŒ–</h1>

    

    <div class="post-meta">
      <time datetime="2017-05-09" class="post-meta__date date">2017-05-09</time> 
	 <span id="busuanzi_container_page_pv" class="post-meta__date date">|&nbsp;&nbsp;viewed <span id="busuanzi_value_page_pv"></span> æ¬¡</span>
      <span class="post-meta__tags tags">

          
            <font class="categories">
            &#8226; åˆ†ç±»:
            <a class="categories-link" href="/categories/Android/">Android</a>
            </font>
          

          
             &#8226; æ ‡ç­¾:
            <font class="tags">
              <a class="tags-link" href="/tags/ä¼˜åŒ–/">ä¼˜åŒ–</a>, <a class="tags-link" href="/tags/å†…å­˜/">å†…å­˜</a>
            </font>
          

      </span>
    </div>
    
    

  </header>

  <section id="post-content" class="article-content post">
    <p>æœ¬ç« å‚è€ƒgoogleå®˜æ–¹æ–‡æ¡£ï¼Œæ€»ç»“äº†androidå¼€å‘è¿‡ç¨‹ä¸­å†…å­˜ä¼˜åŒ–çš„æ–¹æ³•ï¼ŒåŒæ—¶ï¼Œç»“åˆå®é™…å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°çš„OOMï¼Œæ€»ç»“äº†éƒ¨åˆ†ç»éªŒã€‚ä¸å½“ä¹‹å¤„ï¼Œè¯·éšæ—¶æå‡ºã€‚<br><a id="more"></a></p>
<blockquote>
<p>Random-access memory (RAM) is a valuable resource in any software development environment,<br>but itâ€™s even more valuable on a mobile operating system where physical memory is often constrained.<br>Although both the Android Runtime (ART) and Dalvik virtual machine perform routine garbage collection,<br>this does not mean you can ignore when and where your app allocates and releases memory</p>
</blockquote>
<p>éšæœºå­˜å–å­˜å‚¨å™¨ï¼ˆRAMï¼‰æ˜¯ä»»ä½•è½¯ä»¶å¼€å‘ç¯å¢ƒä¸­çš„å®è´µèµ„æºï¼Œä½†åœ¨ç‰©ç†å†…å­˜é€šå¸¸å—é™åˆ¶çš„ç§»åŠ¨æ“ä½œç³»ç»Ÿä¸Šæ›´ä¸ºæœ‰ä»·å€¼ã€‚<br>å°½ç®¡Android Runtimeï¼ˆARTï¼‰å’ŒDalvikè™šæ‹Ÿæœºéƒ½æ‰§è¡Œå¸¸è§„åƒåœ¾æ”¶é›†ï¼Œä½†è¿™å¹¶ä¸æ„å‘³ç€æ‚¨å¯ä»¥å¿½ç•¥åº”ç”¨ç¨‹åºåˆ†é…å’Œé‡Šæ”¾å†…å­˜çš„æ—¶é—´å’Œä½ç½®</p>
<h2 id="æŸ¥çœ‹å†…å­˜ä½¿ç”¨æƒ…å†µ"><a href="#æŸ¥çœ‹å†…å­˜ä½¿ç”¨æƒ…å†µ" class="headerlink" title="æŸ¥çœ‹å†…å­˜ä½¿ç”¨æƒ…å†µ"></a>æŸ¥çœ‹å†…å­˜ä½¿ç”¨æƒ…å†µ</h2><ul>
<li>1 ä½¿ç”¨android studioè‡ªå¸¦çš„ Memory MonitoræŸ¥çœ‹<br>è¯¥å·¥å…·æ˜¾ç¤ºå¯ç”¨å’Œåˆ†é…çš„Javaå†…å­˜éšæ—¶é—´çš„å›¾ï¼ŒåŒ…æ‹¬åƒåœ¾å›æ”¶äº‹ä»¶<br><img src="https://raw.githubusercontent.com/Mrxyx/MarkPhotos/master/Res/2017050901.png" alt=""></li>
<li>2 ä½¿ç”¨android studioè‡ªå¸¦çš„allocation Tracker tool<br>åˆ†é…è·Ÿè¸ªå™¨è®°å½•åº”ç”¨ç¨‹åºçš„å†…å­˜åˆ†é…ï¼Œå¹¶åˆ—å‡ºåˆ†æå¿«ç…§ä¸­çš„æ‰€æœ‰å·²åˆ†é…å¯¹è±¡ã€‚æ‚¨å¯ä»¥ä½¿ç”¨æ­¤å·¥å…·æ¥è·Ÿè¸ªåˆ†é…å¤ªå¤šå¯¹è±¡çš„éƒ¨åˆ†ä»£ç <br><img src="https://raw.githubusercontent.com/Mrxyx/MarkPhotos/master/Res/2017050902.png" alt=""></li>
</ul>
<h2 id="ä¼˜åŒ–å†…å­˜çš„æ–¹æ¡ˆ"><a href="#ä¼˜åŒ–å†…å­˜çš„æ–¹æ¡ˆ" class="headerlink" title="ä¼˜åŒ–å†…å­˜çš„æ–¹æ¡ˆ"></a>ä¼˜åŒ–å†…å­˜çš„æ–¹æ¡ˆ</h2><h4 id="1-ä½¿ç”¨onTrimMemoryåœ¨åº”ç”¨UIéšè—æ—¶é‡Šæ”¾UIèµ„æºæ¥é‡Šæ”¾å†…å­˜"><a href="#1-ä½¿ç”¨onTrimMemoryåœ¨åº”ç”¨UIéšè—æ—¶é‡Šæ”¾UIèµ„æºæ¥é‡Šæ”¾å†…å­˜" class="headerlink" title="1 ä½¿ç”¨onTrimMemoryåœ¨åº”ç”¨UIéšè—æ—¶é‡Šæ”¾UIèµ„æºæ¥é‡Šæ”¾å†…å­˜"></a>1 ä½¿ç”¨onTrimMemoryåœ¨åº”ç”¨UIéšè—æ—¶é‡Šæ”¾UIèµ„æºæ¥é‡Šæ”¾å†…å­˜</h4><p>è¯·æ³¨æ„ï¼šè¿™ä¸ªç©æ„ä¸åŒäºonStopï¼Œä½ çš„åº”ç”¨ä»…ä»…ä¼šåœ¨æ‰€æœ‰UIç»„ä»¶çš„è¢«éšè—çš„æ—¶å€™æ¥æ”¶åˆ°onTrimMemory()çš„å›è°ƒå¹¶å¸¦æœ‰å‚æ•°TRIM_MEMORY_UI_HIDDENã€‚<br>è¿™ä¸onStop()çš„å›è°ƒæ˜¯ä¸åŒçš„ï¼ŒonStopä¼šåœ¨activityçš„å®ä¾‹éšè—æ—¶ä¼šæ‰§è¡Œï¼Œä¾‹å¦‚å½“ç”¨æˆ·ä»ä½ çš„appçš„æŸä¸ªactivityè·³è½¬åˆ°å¦å¤–ä¸€ä¸ªactivityæ—¶å‰é¢activityçš„onStop()ä¼šè¢«æ‰§è¡Œã€‚<br>å› æ­¤ä½ åº”è¯¥å®ç°onStopå›è°ƒï¼Œå¹¶ä¸”åœ¨æ­¤å›è°ƒé‡Œé¢é‡Šæ”¾activityçš„èµ„æºï¼Œä¾‹å¦‚é‡Šæ”¾ç½‘ç»œè¿æ¥ï¼Œæ³¨é”€ç›‘å¬å¹¿æ’­æ¥æ”¶è€…ã€‚é™¤éæ¥æ”¶åˆ°onTrimMemory(TRIM_MEMORY_UI_HIDDEN))çš„å›è°ƒï¼Œ<br>å¦è€…ä½ ä¸åº”è¯¥é‡Šæ”¾ä½ çš„UIèµ„æºã€‚è¿™ç¡®ä¿äº†ç”¨æˆ·ä»å…¶ä»–activityåˆ‡å›æ¥æ—¶ï¼Œä½ çš„UIèµ„æºä»ç„¶å¯ç”¨ï¼Œå¹¶ä¸”å¯ä»¥è¿…é€Ÿæ¢å¤activityã€‚</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div></pre></td><td class="code"><pre><div class="line">import android.content.ComponentCallbacks2;</div><div class="line">// Other import statements ...</div><div class="line"></div><div class="line">public class MainActivity extends AppCompatActivity</div><div class="line">    implements ComponentCallbacks2 &#123;</div><div class="line"></div><div class="line">    // Other activity code ...</div><div class="line"></div><div class="line">    /**</div><div class="line">     * Release memory when the UI becomes hidden or when system resources become low.</div><div class="line">     * @param level the memory-related event that was raised.</div><div class="line">     */</div><div class="line">    public void onTrimMemory(int level) &#123;</div><div class="line"></div><div class="line">        // Determine which lifecycle or system event was raised.</div><div class="line">        switch (level) &#123;</div><div class="line"></div><div class="line">            case ComponentCallbacks2.TRIM_MEMORY_UI_HIDDEN:</div><div class="line"></div><div class="line">                /*</div><div class="line">                   Release any UI objects that currently hold memory.</div><div class="line"></div><div class="line">                   The user interface has moved to the background.</div><div class="line">                */</div><div class="line"></div><div class="line">                break;</div><div class="line">	    //ä½ çš„appæ­£åœ¨è¿è¡Œå¹¶ä¸”ä¸ä¼šè¢«åˆ—ä¸ºå¯æ€æ­»çš„ã€‚ä½†æ˜¯è®¾å¤‡æ­¤æ—¶æ­£è¿è¡Œäºä½å†…å­˜çŠ¶æ€ä¸‹ï¼Œç³»ç»Ÿå¼€å§‹è§¦å‘æ€æ­»LRU Cacheä¸­çš„Processçš„æœºåˆ¶</div><div class="line">            case ComponentCallbacks2.TRIM_MEMORY_RUNNING_MODERATE:	</div><div class="line"></div><div class="line">		break;</div><div class="line">	    //ä½ çš„appæ­£åœ¨è¿è¡Œä¸”æ²¡æœ‰è¢«åˆ—ä¸ºå¯æ€æ­»çš„ã€‚ä½†æ˜¯è®¾å¤‡æ­£è¿è¡Œäºæ›´ä½å†…å­˜çš„çŠ¶æ€ä¸‹ï¼Œä½ åº”è¯¥é‡Šæ”¾ä¸ç”¨çš„èµ„æºç”¨æ¥æå‡ç³»ç»Ÿæ€§èƒ½ï¼ˆä½†æ˜¯è¿™ä¹Ÿä¼šç›´æ¥å½±å“åˆ°ä½ çš„appçš„æ€§èƒ½ï¼‰ã€‚</div><div class="line">            case ComponentCallbacks2.TRIM_MEMORY_RUNNING_LOW:</div><div class="line"></div><div class="line">		break;</div><div class="line">	    //ä½ çš„appä»åœ¨è¿è¡Œï¼Œä½†æ˜¯ç³»ç»Ÿå·²ç»æŠŠLRU Cacheä¸­çš„å¤§å¤šæ•°è¿›ç¨‹éƒ½å·²ç»æ€æ­»ï¼Œå› æ­¤ä½ åº”è¯¥ç«‹å³é‡Šæ”¾æ‰€æœ‰éå¿…é¡»çš„èµ„æºã€‚å¦‚æœç³»ç»Ÿä¸èƒ½å›æ”¶åˆ°è¶³å¤Ÿçš„RAMæ•°é‡ï¼Œ</div><div class="line">		//ç³»ç»Ÿå°†ä¼šæ¸…é™¤æ‰€æœ‰çš„LRUç¼“å­˜ä¸­çš„è¿›ç¨‹ï¼Œå¹¶ä¸”å¼€å§‹æ€æ­»é‚£äº›ä¹‹å‰è¢«è®¤ä¸ºä¸åº”è¯¥æ€æ­»çš„è¿›ç¨‹ï¼Œä¾‹å¦‚é‚£ä¸ªåŒ…å«äº†ä¸€ä¸ªè¿è¡Œæ€Serviceçš„è¿›ç¨‹ã€‚</div><div class="line">            case ComponentCallbacks2.TRIM_MEMORY_RUNNING_CRITICAL:</div><div class="line"></div><div class="line">                /*</div><div class="line">                   Release any memory that your app doesn&apos;t need to run.</div><div class="line"></div><div class="line">                   The device is running low on memory while the app is running.</div><div class="line">                   The event raised indicates the severity of the memory-related event.</div><div class="line">                   If the event is TRIM_MEMORY_RUNNING_CRITICAL, then the system will</div><div class="line">                   begin killing background processes.</div><div class="line">                */</div><div class="line"></div><div class="line">                break;</div><div class="line">	    //ç³»ç»Ÿæ­£è¿è¡Œäºä½å†…å­˜çŠ¶æ€å¹¶ä¸”ä½ çš„è¿›ç¨‹æ­£å¤„äºLRUç¼“å­˜åå•ä¸­æœ€ä¸å®¹æ˜“æ€æ‰çš„ä½ç½®ã€‚å°½ç®¡ä½ çš„appè¿›ç¨‹å¹¶ä¸ æ˜¯å¤„äºè¢«æ€æ‰çš„é«˜å±é™©çŠ¶æ€ï¼Œ</div><div class="line">	    //ç³»ç»Ÿå¯èƒ½å·²ç»å¼€å§‹æ€æ‰LRUç¼“å­˜ä¸­çš„å…¶ä»–è¿›ç¨‹äº†ã€‚ä½ åº”è¯¥é‡Šæ”¾é‚£äº›å®¹æ˜“æ¢å¤çš„èµ„æºï¼Œä»¥ä¾¿äºä½ çš„è¿›ç¨‹å¯ä»¥ä¿ç•™ä¸‹æ¥ï¼Œè¿™æ ·å½“ç”¨æˆ·å›é€€åˆ°ä½ çš„appçš„æ—¶å€™æ‰èƒ½å¤Ÿè¿…é€Ÿæ¢å¤ã€‚</div><div class="line">            case ComponentCallbacks2.TRIM_MEMORY_BACKGROUND:</div><div class="line"></div><div class="line">		break;</div><div class="line">	    //ç³»ç»Ÿæ­£è¿è¡Œäºä½å†…å­˜çŠ¶æ€å¹¶ä¸”ä½ çš„è¿›ç¨‹å·²ç»å·²ç»æ¥è¿‘LRUåå•çš„ä¸­éƒ¨ä½ç½®ã€‚å¦‚æœç³»ç»Ÿå¼€å§‹å˜å¾—æ›´åŠ å†…å­˜ç´§å¼ ï¼Œä½ çš„è¿›ç¨‹æ˜¯æœ‰å¯èƒ½è¢«æ€æ­»çš„</div><div class="line">            case ComponentCallbacks2.TRIM_MEMORY_MODERATE:</div><div class="line"></div><div class="line">		break;</div><div class="line">	    //ç³»ç»Ÿæ­£è¿è¡Œä¸ä½å†…å­˜çš„çŠ¶æ€å¹¶ä¸”ä½ çš„è¿›ç¨‹æ­£å¤„äºLRUåå•ä¸­æœ€å®¹æ˜“è¢«æ€æ‰çš„ä½ç½®ã€‚ä½ åº”è¯¥é‡Šæ”¾ä»»ä½•ä¸å½±å“ä½ çš„appæ¢å¤çŠ¶æ€çš„èµ„æº</div><div class="line">            case ComponentCallbacks2.TRIM_MEMORY_COMPLETE:</div><div class="line"></div><div class="line">                /*</div><div class="line">                   Release as much memory as the process can.</div><div class="line"></div><div class="line">                   The app is on the LRU list and the system is running low on memory.</div><div class="line">                   The event raised indicates where the app sits within the LRU list.</div><div class="line">                   If the event is TRIM_MEMORY_COMPLETE, the process will be one of</div><div class="line">                   the first to be terminated.</div><div class="line">                */</div><div class="line"></div><div class="line">                break;</div><div class="line"></div><div class="line">            default:</div><div class="line">                /*</div><div class="line">                  Release any non-critical data structures.</div><div class="line"></div><div class="line">                  The app received an unrecognized memory level value</div><div class="line">                  from the system. Treat this as a generic low-memory message.</div><div class="line">                */</div><div class="line">                break;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>è¿™ä¸ªå›è°ƒæ”¯æŒAPI14ä»¥ä¸Šï¼Œè¦å…¼å®¹14ä»¥ä¸‹å¯ä»¥ä½¿ç”¨ onLowMemory()</p>
</blockquote>
<h4 id="2-è°¨æ…ä½¿ç”¨services-å¯ä»¥é€‰æ‹©intentservice-ä»£æ›¿service"><a href="#2-è°¨æ…ä½¿ç”¨services-å¯ä»¥é€‰æ‹©intentservice-ä»£æ›¿service" class="headerlink" title="2 è°¨æ…ä½¿ç”¨services,å¯ä»¥é€‰æ‹©intentservice ä»£æ›¿service"></a>2 è°¨æ…ä½¿ç”¨services,å¯ä»¥é€‰æ‹©intentservice ä»£æ›¿service</h4><p> å®ƒä¼šåœ¨å¤„ç†å®Œäº¤ä»£ç»™å®ƒçš„intentä»»åŠ¡ä¹‹åå°½å¿«ç»“æŸè‡ªå·±</p>
<h4 id="3-ä½¿ç”¨ArrayMap-SparseArrayä»£æ›¿hashmapç­‰ä¼ ç»Ÿæ•°æ®ç»“æ„"><a href="#3-ä½¿ç”¨ArrayMap-SparseArrayä»£æ›¿hashmapç­‰ä¼ ç»Ÿæ•°æ®ç»“æ„" class="headerlink" title="3 ä½¿ç”¨ArrayMap/SparseArrayä»£æ›¿hashmapç­‰ä¼ ç»Ÿæ•°æ®ç»“æ„"></a>3 ä½¿ç”¨ArrayMap/SparseArrayä»£æ›¿hashmapç­‰ä¼ ç»Ÿæ•°æ®ç»“æ„</h4><h4 id="4-æ³¨æ„ä»£ç æŠ½è±¡ï¼Œå°‘ç”¨enum"><a href="#4-æ³¨æ„ä»£ç æŠ½è±¡ï¼Œå°‘ç”¨enum" class="headerlink" title="4 æ³¨æ„ä»£ç æŠ½è±¡ï¼Œå°‘ç”¨enum"></a>4 æ³¨æ„ä»£ç æŠ½è±¡ï¼Œå°‘ç”¨enum</h4><p>æŠ½è±¡çš„ä»£ä»·æ˜¯å·¨å¤§çš„ï¼šä¸€èˆ¬æ¥è¯´ï¼Œå®ƒä»¬éœ€è¦æ›´å¤šçš„ä»£ç éœ€è¦æ‰§è¡Œï¼Œéœ€è¦æ›´å¤šçš„æ—¶é—´å’Œæ›´å¤šçš„RAMæ‰èƒ½å°†è¯¥ä»£ç æ˜ å°„åˆ°å†…å­˜ä¸­</p>
<blockquote>
<p>For example, enums often require more than twice as much memory as static constants. You should strictly avoid using enums on Android</p>
</blockquote>
<h4 id="5-è°¨æ…ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼Œç§»é™¤å†…å­˜ä½¿ç”¨å¤§çš„åº“å’Œèµ„æºæ–‡ä»¶"><a href="#5-è°¨æ…ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼Œç§»é™¤å†…å­˜ä½¿ç”¨å¤§çš„åº“å’Œèµ„æºæ–‡ä»¶" class="headerlink" title="5 è°¨æ…ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼Œç§»é™¤å†…å­˜ä½¿ç”¨å¤§çš„åº“å’Œèµ„æºæ–‡ä»¶"></a>5 è°¨æ…ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼Œç§»é™¤å†…å­˜ä½¿ç”¨å¤§çš„åº“å’Œèµ„æºæ–‡ä»¶</h4><p> ä½ çš„ä»£ç ä¸­çš„ä¸€äº›èµ„æºå’Œåº“å¯ä»¥åœ¨ä¸çŸ¥é“çš„æƒ…å†µä¸‹æ¶ˆé™¤å†…å­˜ã€‚<br> æ‚¨çš„APKçš„æ€»ä½“å°ºå¯¸ï¼ˆåŒ…æ‹¬ç¬¬ä¸‰æ–¹åº“æˆ–åµŒå…¥å¼èµ„æºï¼‰å¯èƒ½ä¼šå½±å“åº”ç”¨ç¨‹åºæ¶ˆè€—å¤šå°‘å†…å­˜ã€‚<br> æ‚¨å¯ä»¥é€šè¿‡ä»ä»£ç ä¸­åˆ é™¤ä»»ä½•å†—ä½™çš„ï¼Œä¸å¿…è¦çš„æˆ–è†¨èƒ€çš„ç»„ä»¶ï¼Œèµ„æºæˆ–åº“æ¥æé«˜åº”ç”¨ç¨‹åºçš„å†…å­˜æ¶ˆè€—</p>
<h4 id="6-å‡å°APkå¤§å°"><a href="#6-å‡å°APkå¤§å°" class="headerlink" title="6 å‡å°APkå¤§å°"></a>6 å‡å°APkå¤§å°</h4><p> æ‚¨å¯ä»¥é€šè¿‡å‡å°‘åº”ç”¨ç¨‹åºçš„æ€»ä½“å¤§å°æ¥æ˜¾ç€é™ä½åº”ç”¨ç¨‹åºçš„å†…å­˜ä½¿ç”¨é‡ã€‚<br> ä½å›¾å¤§å°ï¼Œèµ„æºï¼ŒåŠ¨ç”»æ¡†æ¶å’Œç¬¬ä¸‰æ–¹åº“éƒ½å¯ä»¥å¸®åŠ©æ‚¨çš„APKçš„å¤§å°ã€‚<br> Android Studioå’ŒAndroid SDKæä¾›å¤šç§å·¥å…·æ¥å¸®åŠ©æ‚¨å‡å°‘èµ„æºå’Œå¤–éƒ¨ä¾èµ–å…³ç³»çš„å¤§å°<br> example <a href="https://developer.android.google.cn/topic/performance/reduce-apk-size.html" target="_blank" rel="external">Reduce APK Size</a></p>
<h4 id="7-å¦‚æœé¡¹ç›®å¿…é¡»éœ€è¦ç”¨åˆ°ä¾èµ–æ³¨å…¥æ¡†æ¶ï¼Œæ¨èä½¿ç”¨Dragger2-å®˜æ–¹æ¨è"><a href="#7-å¦‚æœé¡¹ç›®å¿…é¡»éœ€è¦ç”¨åˆ°ä¾èµ–æ³¨å…¥æ¡†æ¶ï¼Œæ¨èä½¿ç”¨Dragger2-å®˜æ–¹æ¨è" class="headerlink" title="7 å¦‚æœé¡¹ç›®å¿…é¡»éœ€è¦ç”¨åˆ°ä¾èµ–æ³¨å…¥æ¡†æ¶ï¼Œæ¨èä½¿ç”¨Dragger2(å®˜æ–¹æ¨è)"></a>7 å¦‚æœé¡¹ç›®å¿…é¡»éœ€è¦ç”¨åˆ°ä¾èµ–æ³¨å…¥æ¡†æ¶ï¼Œæ¨èä½¿ç”¨<a href="https://google.github.io/dagger/" target="_blank" rel="external">Dragger2</a>(å®˜æ–¹æ¨è)</h4><p> Daggerä¸ä½¿ç”¨åå°„æ¥æ‰«ææ‚¨çš„åº”ç”¨ç¨‹åºçš„ä»£ç ã€‚ Daggerçš„é™æ€ç¼–è¯‘æ—¶å®ç°æ„å‘³ç€å®ƒå¯ä»¥åœ¨Androidåº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ï¼Œè€Œæ— éœ€è¿è¡Œæ—¶è´¹ç”¨æˆ–å†…å­˜ä½¿ç”¨ã€‚</p>
<h4 id="8-ä½¿ç”¨LeakCanaryå¼€æºæ§ä»¶ï¼Œå¯ä»¥å¾ˆå¥½çš„å¸®åŠ©æˆ‘ä»¬å‘ç°å†…å­˜æ³„éœ²çš„æƒ…å†µ"><a href="#8-ä½¿ç”¨LeakCanaryå¼€æºæ§ä»¶ï¼Œå¯ä»¥å¾ˆå¥½çš„å¸®åŠ©æˆ‘ä»¬å‘ç°å†…å­˜æ³„éœ²çš„æƒ…å†µ" class="headerlink" title="8 ä½¿ç”¨LeakCanaryå¼€æºæ§ä»¶ï¼Œå¯ä»¥å¾ˆå¥½çš„å¸®åŠ©æˆ‘ä»¬å‘ç°å†…å­˜æ³„éœ²çš„æƒ…å†µ"></a>8 ä½¿ç”¨LeakCanaryå¼€æºæ§ä»¶ï¼Œå¯ä»¥å¾ˆå¥½çš„å¸®åŠ©æˆ‘ä»¬å‘ç°å†…å­˜æ³„éœ²çš„æƒ…å†µ</h4><p> å…·ä½“çš„ä½¿ç”¨è¯·æŸ¥çœ‹<a href="https://github.com/square/leakcanary" target="_blank" rel="external">å®˜æ–¹Github</a>æˆ–è€…<a href="https://www.liaohuqiu.net/cn/posts/leak-canary-read-me/" target="_blank" rel="external">ä¸­æ–‡èµ„æ–™</a><br> å½“ç„¶è¿˜å¯ä»¥ä½¿ç”¨MAT</p>
<p> ä»¥ä¸Šå‚è€ƒè‡ª<a href="https://developer.android.google.cn/topic/performance/memory.html" target="_blank" rel="external">androidå®˜æ–¹æ€§èƒ½ä¼˜åŒ–èµ„æ–™</a></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul>
<li>LeakCanaryå€¼å¾—æ¨èï¼Œç”¨äºç›‘å¬é¡¹ç›®ä¸­çš„å†…å­˜æ³„éœ²ã€‚<br>ç›‘å¬ä¼šå‘ç°é™¤äº†å®˜æ–¹SDKä¸­çš„æ–¹æ³•å¯¼è‡´çš„å†…å­˜æ³„éœ²å¤–ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯é™æ€å˜é‡çš„å¼•ç”¨æœªåŠæ—¶é”€æ¯å¯¼è‡´çš„ã€‚</li>
<li>åŠ è½½å¤§å›¾ï¼ŒåŠæ˜“äº§ç”ŸOOMã€‚<br>å› æ­¤åœ¨åŠ è½½å›¾ç‰‡çš„æ—¶å€™ï¼Œéœ€è¦æˆ‘ä»¬å¯¹å›¾ç‰‡è¿›è¡Œå‹ç¼©å¤„ç†ï¼ˆå›¾ç‰‡çš„å¤§å°ï¼Œè´¨é‡å‹ç¼©ï¼‰ï¼Œé€‰æ‹©åˆé€‚å°ºå¯¸çš„å›¾ç‰‡è¿›è¡ŒåŠ è½½ã€‚åŒæ—¶ï¼Œéœ€è¦åŠæ—¶recycleä¸´æ—¶å›¾ç‰‡ã€‚</li>
<li>å‡å°‘ä¸å¿…è¦çš„å…¨å±€å˜é‡ï¼ˆå®˜æ–¹æ–‡æ¡£ç»™å‡ºäº†åŒæ ·çš„å»ºè®®ï¼‰ï¼Œé¿å…é™æ€å˜é‡å¼•ç”¨æ¶ˆè€—æ›´å¤šçš„èµ„æºã€‚</li>
<li>å‡å°‘æšä¸¾ç±»å‹çš„ä½¿ç”¨ã€‚</li>
<li>åœ¨ä½¿ç”¨SQLiteæ—¶åŠæ—¶é”€æ¯cursorã€‚<br>ä»¥ä¸Šä¸ºé¡¹ç›®ä¸­é‡åˆ°çš„å†…å­˜ä¼˜åŒ–æ–¹æ¡ˆï¼Œå…¶ä»–æ–¹æ¡ˆè‹¥æœ‰é—æ¼ä¼šåŠæ—¶è¡¥å……ã€‚</li>
</ul>
<p>æ’ä¸€å¥ï¼šè™½ç„¶ç°åœ¨æ‰‹æœºå†…å­˜æ…¢æ…¢åœ¨å˜å¤§ï¼Œå¿…è¦çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç©ºé—´æ¢æ—¶é—´ï¼Œä½†æ˜¯åœ¨è‡ªå·±èƒ½åŠ›èŒƒå›´å†…ï¼Œä¸æ–­çš„ä¼˜åŒ–å†…å­˜ä½¿ç”¨ï¼Œåº”è¯¥ç®—æ˜¯æˆ‘ä»¬çš„èŒä¸šé“å¾·å§ğŸ‘ã€‚</p>
<p>è™½ç„¶æˆ‘ç°åœ¨æ˜¯æ¸£æ¸£ï¼Œä½†æ˜¯äº”å¹´åå‘¢ï¼Ÿå˜»å˜»</p>

  </section>

  
  
  
<section class="post-comments">
<div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div>
<script>
  var cloudTieConfig = {
    url: document.location.href, 
    sourceId: "",
    productKey: "33bdbc28951e4ef7a555f39a875c878a",
    target: "cloud-tie-wrapper"
  };
</script>
<script src="https://img1.cache.netease.com/f2e/tie/yun/sdk/loader.js"></script>
</section>

  
</article>


            <footer class="footer">

    <span class="footer__copyright">&copy; 2014-2015. | ç”±<a href="https://hexo.io/">Hexo</a>å¼ºåŠ›é©±åŠ¨ | ä¸»é¢˜<a href="https://github.com/someus/huno">Huno</a> | æœ¬ç«™æ€»ç‚¹å‡»<span id="busuanzi_value_site_pv"></span>æ¬¡ | æ‚¨æ˜¯ç¬¬<span id="busuanzi_value_site_uv"></span>ä½è®¿å®¢</span>
   

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>

</footer>
        </div>
    </div>

    <!-- js files -->
    <script src="/js/jquery.min.js"></script>
    <script src="/js/main.js"></script>
    <script src="/js/scale.fix.js"></script>
    

    

    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript"> 
        $(document).ready(function(){
            MathJax.Hub.Config({ 
                tex2jax: {inlineMath: [['[latex]','[/latex]'], ['\\(','\\)']]} 
            });
        });
    </script>


    

    <script src="/js/awesome-toc.min.js"></script>
    <script>
        $(document).ready(function(){
            $.awesome_toc({
                overlay: true,
                contentId: "post-content",
            });
        });
    </script>


    <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?99d62de6b248a2fbdf4b9deb88ec07dc";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

    
    <!--kill ie6 -->
<!--[if IE 6]>
  <script src="//letskillie6.googlecode.com/svn/trunk/2/zh_CN.js"></script>
<![endif]-->

</body>
</html>
